# Financial Analysis Tools Suite

## é¡¹ç›®æ¦‚è¿° (Project Overview)

æœ¬é¡¹ç›®æ˜¯ä¸€å¥—ä¸“ä¸šçš„è´¢åŠ¡åˆ†æå·¥å…·é›†ï¼ŒåŒ…å«ä¼šè®¡åˆ†å½•æ£€æŸ¥å™¨å’Œå¯¹è´¦åˆ†æå™¨ï¼Œæ”¯æŒå¤šå¹´åº¦æ•°æ®åˆ†æå’Œå¤šå…¬å¸è´¦ç°¿å¤„ç†ã€‚æ‰€æœ‰å·¥å…·åŸºäºPythonå¼€å‘ï¼Œä½¿ç”¨pandaså’Œopenpyxlè¿›è¡ŒExcelæ•°æ®å¤„ç†ã€‚

This project is a comprehensive suite of financial analysis tools, including accounting voucher analyzers and reconciliation analyzers, supporting multi-year data analysis and multi-company ledger processing.

## ğŸ› ï¸ å·¥å…·åˆ—è¡¨ (Tools List)

### 1. ä¼šè®¡åˆ†å½•æ£€æŸ¥å™¨ (Accounting Voucher Analyzers)

#### ä¸»è¦è„šæœ¬ (Main Script)
- **`accounting_voucher_analyzer_2025.py`** â€” æœ€æ–°ç‰ˆæœ¬ï¼Œæ”¯æŒ2022â€“2025å¹´æ•°æ®

#### åŠŸèƒ½ç‰¹æ€§ (Features)
- âœ… **å¤šå¹´åº¦æ”¯æŒ**: æ”¯æŒ2022-2025å¹´ä¼šè®¡æ•°æ®åˆ†æ
- âœ… **èŠ‚å‡æ—¥è¯†åˆ«**: å†…ç½®ä¸­å›½æ³•å®šèŠ‚å‡æ—¥å’Œè°ƒä¼‘å·¥ä½œæ—¥æ•°æ®
- âœ… **å·¥ä½œæ—¥éªŒè¯**: è‡ªåŠ¨æ£€æŸ¥åˆ†å½•æ—¥æœŸæ˜¯å¦ä¸ºå·¥ä½œæ—¥
- âœ… **æ•°æ®å®Œæ•´æ€§æ£€æŸ¥**: éªŒè¯å‡­è¯å·ã€æ—¥æœŸã€åˆ¶å•äººã€å®¡æ ¸äººç­‰å¿…å¡«å­—æ®µ
- âœ… **äº¤äº’å¼åˆ†æ**: æ”¯æŒæŒ‰å¹´åº¦åˆ†ææˆ–åˆå¹¶åˆ†æ
- âœ… **ExcelæŠ¥å‘Šç”Ÿæˆ**: è‡ªåŠ¨ç”Ÿæˆè¯¦ç»†çš„åˆ†ææŠ¥å‘Š
- âœ… **å¼‚å¸¸å¤„ç†**: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œæ•°æ®éªŒè¯æœºåˆ¶

### 2. å¯¹è´¦åˆ†æå™¨ (Reconciliation Analyzer)

- **`general_reconciliation_analyzer.py`** â€” é€šç”¨CLIå·¥å…·ï¼Œæ”¯æŒæŒ‰è´¦ç°¿/å…¬å¸æ¨¡å¼ç­›é€‰å¹¶è¿›è¡ŒJEä¸TBå¯¹è´¦ã€‚

#### åŠŸèƒ½ç‰¹æ€§ (Features)
- âœ… **JEä¸TBå¯¹è´¦**: è®°è´¦å‡­è¯ä¸è¯•ç®—å¹³è¡¡è¡¨çš„æ˜ç»†å¯¹è´¦ä¸æ±‡æ€»å¯¹è´¦
- âœ… **æ™ºèƒ½æ•°æ®è§£æ**: è‡ªåŠ¨å¤„ç†è´§å¸æ ¼å¼ã€ç§‘ç›®ç¼–ç æå–ä¸æ¸…æ´—
- âœ… **å¤šæ ¼å¼æ”¯æŒ**: é€‚é…ä¸åŒçš„Excelåˆ—ç»“æ„ä¸é‡å¤åˆ—å
- âœ… **å·®å¼‚åˆ†æ**: å€Ÿè´·å·®å¼‚ã€ä»…JEå­˜åœ¨ã€ä»…TBå­˜åœ¨ç­‰åˆ†ç±»
- âœ… **åˆ†ç±»æŠ¥å‘Š**: è¾“å‡ºåŒ…å«æ±‡æ€»ã€å·®å¼‚æ˜ç»†ã€è·³å·æ£€æŸ¥ã€å€Ÿè´·å¹³è¡¡æ£€æŸ¥çš„ExcelæŠ¥å‘Š
- âœ… **å¯é…ç½®ç­›é€‰**: é€šè¿‡ `--patterns` æˆ–é…ç½®æ–‡ä»¶ä¸­çš„ `target_patterns` é€‰æ‹©ç›®æ ‡è´¦ç°¿/å…¬å¸

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚ (System Requirements)

### Pythonç‰ˆæœ¬
- Python 3.7+

### ä¾èµ–åŒ… (Dependencies)
```bash
pip install pandas openpyxl numpy xlsxwriter
```

### æ–‡ä»¶æ ¼å¼è¦æ±‚ (File Format Requirements)
- è¾“å…¥æ–‡ä»¶: Excelæ ¼å¼ (.xlsx)
- è¾“å‡ºæ–‡ä»¶: Excelæ ¼å¼ (.xlsx)

## ğŸš€ ä½¿ç”¨æ–¹æ³• (Usage)

### ä¼šè®¡åˆ†å½•æ£€æŸ¥å™¨ (Accounting Voucher Analyzer)

#### åŸºæœ¬ç”¨æ³•
```bash
# ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬åˆ†æå™¨
python accounting_voucher_analyzer_2025.py

# æŒ‡å®šå¹´ä»½åˆ†æ
python accounting_voucher_analyzer_2025.py 2024
python accounting_voucher_analyzer_2025.py 2025

# åˆå¹¶æ‰€æœ‰å¹´ä»½åˆ†æ
python accounting_voucher_analyzer_2025.py all
```

#### è¾“å…¥æ–‡ä»¶è¦æ±‚
- æ–‡ä»¶ååŒ…å«å¹´ä»½ä¿¡æ¯ (å¦‚: `2024je.xlsx`, `2025je_Q1.xlsx`)
- å¿…é¡»åŒ…å«åˆ—: `å‡­è¯å·`, `æ—¥æœŸ`, `åˆ¶å•äºº`, `å®¡æ ¸äºº`
- æ”¯æŒå¤šä¸ªå·¥ä½œè¡¨çš„Excelæ–‡ä»¶

#### è¾“å‡ºæ–‡ä»¶
- `ä¼šè®¡åˆ†å½•æ£€æŸ¥æŠ¥å‘Š_YYYYMMDD_HHMMSS.xlsx`

#### è‡ªåŠ¨æ‰«æ (Auto Discovery)
`accounting_voucher_analyzer_2025.py` ä¼šè‡ªåŠ¨æ‰«æå½“å‰ç›®å½•ä¸‹åŒ…å«å¹´ä»½ä¸ `je`/`JE` å…³é”®è¯çš„Excelæ–‡ä»¶å¹¶è¿›è¡Œåˆ†æï¼›å¯é€šè¿‡å‚æ•°æŒ‡å®šå¹´ä»½æˆ–åˆå¹¶åˆ†ææ‰€æœ‰å¹´ä»½ã€‚

### å¯¹è´¦åˆ†æå™¨ (Reconciliation Analyzer)

#### é€šç”¨CLIç”¨æ³• (General CLI Usage)
```bash
# ä½¿ç”¨é…ç½®æ–‡ä»¶è¿è¡Œ
python general_reconciliation_analyzer.py --config reconciliation_config.json

# åˆ›å»ºç¤ºä¾‹é…ç½®æ–‡ä»¶
python general_reconciliation_analyzer.py --create-config

# ç›´æ¥æŒ‡å®šæ–‡ä»¶ä¸ç­›é€‰æ¨¡å¼
python general_reconciliation_analyzer.py \
  --je-files 2025je1-6.xlsx 2025je7-12.xlsx \
  --tb-file tb2025.xlsx \
  --patterns "BOOK_PATTERN" "COMPANY_PATTERN" \
  --output-prefix "å¯¹è´¦æŠ¥å‘Š"
```

**è¾“å…¥æ–‡ä»¶:**
- `JE` æ˜ç»†æ–‡ä»¶ï¼Œå¦‚: `2025je.xlsx`, `je_2025_part1.xlsx`
- `TB` è¯•ç®—å¹³è¡¡æ–‡ä»¶ï¼Œå¦‚: `tb2025.xlsx`

**è¾“å‡ºæ–‡ä»¶:**
- `å¯¹è´¦æŠ¥å‘Š_<patternæˆ–å…¨éƒ¨è´¦å¥—>_YYYYMMDD_HHMMSS.xlsx`

### é€šç”¨å¯¹è´¦è„šæœ¬ CLI (General Reconciliation CLI)
```bash
# æŸ¥çœ‹å¸®åŠ©
python general_reconciliation_analyzer.py --help

# ä½¿ç”¨å¤šæ¨¡å¼ç­›é€‰è´¦ç°¿/å…¬å¸
python general_reconciliation_analyzer.py \
  --je-files je_2025.xlsx \
  --tb-file tb_2025.xlsx \
  --patterns "PATTERN_A" "PATTERN_B" \
  --threshold 0.01

# ä½¿ç”¨é…ç½®æ–‡ä»¶è¿è¡Œï¼ˆæ¨èï¼‰
python general_reconciliation_analyzer.py --config reconciliation_config.json
```

## ğŸ“Š æŠ¥å‘Šå†…å®¹ (Report Contents)

### ä¼šè®¡åˆ†å½•æ£€æŸ¥æŠ¥å‘Š
- ğŸ“ˆ **ç»Ÿè®¡æ±‡æ€»**: æ€»åˆ†å½•æ•°ã€å¼‚å¸¸åˆ†å½•æ•°ã€é€šè¿‡ç‡
- ğŸ“… **æ—¥æœŸåˆ†æ**: å·¥ä½œæ—¥éªŒè¯ã€èŠ‚å‡æ—¥æ£€æŸ¥
- ğŸ‘¥ **äººå‘˜åˆ†æ**: åˆ¶å•äººã€å®¡æ ¸äººç»Ÿè®¡
- ğŸ” **å¼‚å¸¸æ˜ç»†**: è¯¦ç»†çš„å¼‚å¸¸è®°å½•åˆ—è¡¨
- ğŸ“‹ **å¹´åº¦å¯¹æ¯”**: å¤šå¹´åº¦æ•°æ®å¯¹æ¯”åˆ†æ

### å¯¹è´¦åˆ†ææŠ¥å‘Š
- ğŸ“Š **æ±‡æ€»ç»Ÿè®¡**: æ€»è®°å½•æ•°ã€åŒ¹é…æ•°ã€å·®å¼‚æ•°
- âœ… **æ— å·®å¼‚è®°å½•**: å®Œå…¨åŒ¹é…çš„ç§‘ç›®æ˜ç»†
- âŒ **å­˜åœ¨å·®å¼‚è®°å½•**: å€Ÿè´·æ–¹å·®å¼‚æ˜ç»†
- ğŸ“ **ä»…JEå­˜åœ¨**: åªåœ¨è®°è´¦å‡­è¯ä¸­å­˜åœ¨çš„è®°å½•
- ğŸ“‹ **ä»…TBå­˜åœ¨**: åªåœ¨è¯•ç®—å¹³è¡¡è¡¨ä¸­å­˜åœ¨çš„è®°å½•
- ğŸ’° **é‡‘é¢åˆ†æ**: å€Ÿè´·æ–¹é‡‘é¢å·®å¼‚ç»Ÿè®¡

## ğŸ“‘ TBæ ¼å¼é€‚é… (TB Format Support)

### è¡¨å¤´è¡Œè‡ªåŠ¨æ£€æµ‹
- æ”¯æŒè‡ªåŠ¨æ£€æµ‹TBæ–‡ä»¶ä¸­çš„è¡¨å¤´æ‰€åœ¨è¡Œï¼›å¯é€šè¿‡ `header_row_index` æŒ‡å®š

### åˆ—ç´¢å¼•è®¿é—®ä¸é‡å¤åˆ—å¤„ç†
- å½“åˆ—åé‡å¤æ—¶å¯é€šè¿‡ç´¢å¼•è®¿é—®ï¼›æ”¯æŒ `debit_col_index` ä¸ `credit_col_index`

### é»˜è®¤è´¦ç°¿
- å½“TBæ–‡ä»¶æ— è´¦ç°¿åˆ—æ—¶å¯è®¾ç½® `default_book` ä»¥è‡ªåŠ¨è¡¥å……

### é…ç½®ç¤ºä¾‹
```json
{
  "header_row_index": 0,
  "default_book": "é»˜è®¤è´¦ç°¿",
  "tb_columns": {
    "book": ["æ ¸ç®—è´¦ç°¿åç§°", "è´¦ç°¿"],
    "account_code": "ç§‘ç›®ç¼–ç ",
    "debit": ["æœ¬æœŸå€Ÿæ–¹.1", "å€Ÿæ–¹ç´¯è®¡"],
    "credit": ["æœ¬æœŸè´·æ–¹.1", "è´·æ–¹ç´¯è®¡"],
    "debit_col_index": null,
    "credit_col_index": null
  }
}
```

## ğŸ“ é¡¹ç›®ç»“æ„ (Project Structure)

```
testing/
â”œâ”€â”€ README.md                          # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ requirements.txt                   # Pythonä¾èµ–åŒ…
â”œâ”€â”€ accounting_voucher_analyzer_2025.py# ä¼šè®¡åˆ†å½•æ£€æŸ¥å™¨ï¼ˆæ”¯æŒ2022â€“2025ï¼‰
â”œâ”€â”€ general_reconciliation_analyzer.py # é€šç”¨å¯¹è´¦åˆ†æå™¨CLI
â”œâ”€â”€ utils.py                           # é€šç”¨å·¥å…·å‡½æ•°
â”œâ”€â”€ example_company_config.json        # ç¤ºä¾‹å…¬å¸/è´¦ç°¿é…ç½®
â”œâ”€â”€ tb_format_config_examples.json     # TBæ ¼å¼é…ç½®ç¤ºä¾‹
â”œâ”€â”€ example_usage.py                   # ä½¿ç”¨ç¤ºä¾‹è„šæœ¬
â””â”€â”€ .gitignore                         # Gitå¿½ç•¥æ–‡ä»¶
```

## ğŸ”§ æŠ€æœ¯ç‰¹æ€§ (Technical Features)

### æ•°æ®å¤„ç†èƒ½åŠ›
- **å¤§æ–‡ä»¶æ”¯æŒ**: æ”¯æŒå¤„ç†å¤§å‹Excelæ–‡ä»¶
- **å†…å­˜ä¼˜åŒ–**: ä¼˜åŒ–çš„æ•°æ®åŠ è½½å’Œå¤„ç†ç®—æ³•
- **æ ¼å¼å…¼å®¹**: æ”¯æŒå¤šç§Excelæ ¼å¼å’Œåˆ—ç»“æ„
- **ç¼–ç å¤„ç†**: è‡ªåŠ¨å¤„ç†ä¸­æ–‡å­—ç¬¦ç¼–ç 

### é”™è¯¯å¤„ç†
- **å¼‚å¸¸æ•è·**: å®Œå–„çš„å¼‚å¸¸å¤„ç†æœºåˆ¶
- **æ•°æ®éªŒè¯**: å¤šå±‚æ¬¡çš„æ•°æ®å®Œæ•´æ€§éªŒè¯
- **é”™è¯¯æŠ¥å‘Š**: è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œå»ºè®®
- **å®¹é”™æœºåˆ¶**: éƒ¨åˆ†æ•°æ®é”™è¯¯ä¸å½±å“æ•´ä½“åˆ†æ

### æ€§èƒ½ä¼˜åŒ–
- **å¹¶è¡Œå¤„ç†**: æ”¯æŒå¤šçº¿ç¨‹æ•°æ®å¤„ç†
- **ç¼“å­˜æœºåˆ¶**: æ™ºèƒ½çš„æ•°æ®ç¼“å­˜ç­–ç•¥
- **å¢é‡åˆ†æ**: æ”¯æŒå¢é‡æ•°æ®åˆ†æ
- **èµ„æºç®¡ç†**: è‡ªåŠ¨çš„å†…å­˜å’Œæ–‡ä»¶èµ„æºç®¡ç†

## ğŸ“ æ›´æ–°æ—¥å¿— (Changelog)

### v2025.1 (Latest)
- âœ¨ æ–°å¢2025å¹´æ•°æ®æ”¯æŒ
- ğŸ”§ ä¼˜åŒ–å†…å­˜ä½¿ç”¨æ•ˆç‡
- ğŸ› ä¿®å¤æ—¥æœŸè§£æbug
- ğŸ“Š å¢å¼ºæŠ¥å‘Šæ ¼å¼

### v2024.1
- âœ¨ æ–°å¢å¤šå…¬å¸å¯¹è´¦æ”¯æŒ
- ğŸ”§ æ”¹è¿›ç§‘ç›®ç¼–ç è§£æ
- ğŸ“ˆ ä¼˜åŒ–ç»Ÿè®¡ç®—æ³•

### v2023.1
- âœ¨ åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- ğŸ¯ åŸºç¡€ä¼šè®¡åˆ†å½•æ£€æŸ¥åŠŸèƒ½
- ğŸ“Š åŸºç¡€å¯¹è´¦åˆ†æåŠŸèƒ½

## ğŸ¤ è´¡çŒ®æŒ‡å— (Contributing)

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## ğŸ“„ è®¸å¯è¯ (License)

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚

## ğŸ“ æ”¯æŒä¸è”ç³» (Support & Contact)

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- ğŸ“§ Email: [your-email@example.com]
- ğŸ› Issues: [GitHub Issues](https://github.com/your-repo/issues)
- ğŸ“– Wiki: [é¡¹ç›®Wiki](https://github.com/your-repo/wiki)

## ğŸ™ è‡´è°¢ (Acknowledgments)

æ„Ÿè°¢æ‰€æœ‰ä¸ºæœ¬é¡¹ç›®åšå‡ºè´¡çŒ®çš„å¼€å‘è€…å’Œç”¨æˆ·ã€‚

---

**æ³¨æ„**: ä½¿ç”¨å‰è¯·ç¡®ä¿å·²å®‰è£…æ‰€æœ‰å¿…è¦çš„ä¾èµ–åŒ…ï¼Œå¹¶å‡†å¤‡å¥½ç¬¦åˆæ ¼å¼è¦æ±‚çš„è¾“å…¥æ–‡ä»¶ã€‚

**Note**: Please ensure all required dependencies are installed and input files meet the format requirements before use.